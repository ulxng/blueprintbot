# –ú–∏–∫—Ä–æ—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö Telegram –±–æ—Ç–æ–≤

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Telegram –±–æ—Ç–æ–≤ —Å –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–º–∏ –¥–∏–∞–ª–æ–≥–∞–º–∏, –≥–¥–µ –ª–æ–≥–∏–∫–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ YAML —Ñ–∞–π–ª–∞—Ö, –∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ.

## üéØ –ö–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞–µ—Ç

### ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:
- **–ú–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–µ –æ–ø—Ä–æ—Å–Ω–∏–∫–∏ –∏ –∞–Ω–∫–µ—Ç—ã** - —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤
- **–°–∏—Å—Ç–µ–º—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏** - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- **FAQ –±–æ—Ç—ã** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Å –∫–Ω–æ–ø–æ—á–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π  
- **–õ–∏–¥-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è** - —Å–±–æ—Ä –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –∑–∞—è–≤–æ–∫ –æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–µ—Ä–≤–∏—Å–æ–º
- **–ó–∞—è–≤–∫–∏ –Ω–∞ —É—Å–ª—É–≥–∏** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**YAML –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:**
- –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–Ω–æ–ø–æ–∫
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤ –≤ –¥–∏–∞–ª–æ–≥–∞—Ö
- –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**Go –∫–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:**
- –£—Å–ª–æ–≤–∏—è –∑–∞–ø—É—Å–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (email, –ë–î, API)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
git clone <repo-url>
cd yamlconf

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod download

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export BOT_TOKEN="your_telegram_bot_token"
export SMTP_HOST="smtp.gmail.com"
export SMTP_PORT=465
export SMTP_USERNAME="your_email@gmail.com"
export SMTP_PASSWORD="your_app_password"
export SMTP_DEFAULT_EMAIL_FROM="your_email@gmail.com"
export SMTP_DEFAULT_EMAIL_TO="admin@yourcompany.com"

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
go run .
```

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (–±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–π)

–î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –º–µ–Ω—é –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª—ã –≤ `responses/`:

### 1. –°–æ–∑–¥–∞–π—Ç–µ YAML —Ñ–∞–π–ª —Å –æ—Ç–≤–µ—Ç–∞–º–∏

```yaml
# responses/products.yaml
products.catalog:
    text: "üì¶ –ù–∞—à –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤"
    buttons:
        - text: "üíé –ü—Ä–µ–º–∏—É–º"
          code: products.premium
        - text: "üî• –•–∏—Ç—ã –ø—Ä–æ–¥–∞–∂"
          code: products.bestsellers
        - text: "‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"
          code: main.menu

products.premium:
    text: |
        üíé –ü—Ä–µ–º–∏—É–º –ø—Ä–æ–¥—É–∫—Ç—ã:
        ‚Ä¢ –¢–æ–≤–∞—Ä 1 - 1000‚ÇΩ
        ‚Ä¢ –¢–æ–≤–∞—Ä 2 - 1500‚ÇΩ
        ‚Ä¢ –¢–æ–≤–∞—Ä 3 - 2000‚ÇΩ
    buttons:
        - text: "‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É"
          code: products.catalog
```

### 2. –î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

```yaml
# responses/main.yaml
main.menu:
    text: –†–∞–∑–¥–µ–ª—ã
    buttons:
        - text: –ö–∞—Ç–∞–ª–æ–≥
          code: products.catalog  # –°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª
        - text: –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞
          code: support.faq.intro
```

**–ì–æ—Ç–æ–≤–æ!** –ü—Ä–æ—Å—Ç—ã–µ –¥–∏–∞–ª–æ–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –∫–Ω–æ–ø–æ–∫.

## üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (—Å–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏)

–î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ flows:

### 1. –û–ø–∏—à–∏—Ç–µ flow –≤ YAML

```yaml
# flow/config.yaml
order:
    id: order
    steps:
        idle:
            next: ask_product
        ask_product:
            message:
                text: "–ö–∞–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?"
                answers:
                    - text: "üíé –ü—Ä–µ–º–∏—É–º"
                    - text: "üî• –ë–∞–∑–æ–≤—ã–π"
                    - text: "‚≠ê –≠–∫–æ–Ω–æ–º"
            code: product
            action: collect_text
            next: ask_quantity
        ask_quantity:
            message:
                text: "–°–∫–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü –Ω—É–∂–Ω–æ?"
            code: quantity
            action: collect_text
            next: ask_contact
        ask_contact:
            message:
                text: "–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è —Å–≤—è–∑–∏"
                answers:
                    - text: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä"
                      request_contact: true
            code: phone
            action: collect_contact
            next: complete
        complete:
            message:
                text: "‚úÖ –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞."
            action: send_order_request
```

### 2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ flow –≤ –∫–æ–¥–µ

```go
// routes.go - –¥–æ–±–∞–≤—å—Ç–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é registerFlows()
func (a *App) registerFlows() {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ flows ...
    
    // –ù–æ–≤—ã–π flow –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
    orderFlow := a.flowRegistry.CreateFlow("order")
    orderFlow.InitConditionFunc = func(c tele.Context) bool {
        // –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ
        return c.Callback() != nil && c.Callback().Data == "order.start"
    }
}
```

### 3. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

```go
// routes.go - –¥–æ–±–∞–≤—å—Ç–µ –≤ registerRoutes()
a.bot.Handle("send_order_request", a.onOrderComplete)

// handlers.go - –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
func (a *App) onOrderComplete(c tele.Context) error {
    if c.Get("session") == nil {
        return nil
    }
    
    session := c.Get("session").(*state.Session)
    
    // –§–æ—Ä–º–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    notification := fmt.Sprintf("–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è %d:\n", session.UserID)
    for key, value := range session.Data {
        switch v := value.(type) {
        case string:
            notification += fmt.Sprintf("%s: %s\n", key, v)
        case *tele.Contact:
            if v != nil {
                notification += fmt.Sprintf("%s: %s\n", key, v.PhoneNumber)
            }
        }
    }
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º email –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
    go func() {
        if err := a.mailer.Send(notification, "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑"); err != nil {
            log.Printf("Failed to send order email: %v", err)
        }
    }()
    
    return nil
}
```

### 4. –î–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É –∑–∞–ø—É—Å–∫–∞

```yaml
# responses/main.yaml
main.menu:
    text: –†–∞–∑–¥–µ–ª—ã
    buttons:
        - text: "üõí –°–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑"
          code: order.start  # –≠—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç flow
        - text: –ö–∞—Ç–∞–ª–æ–≥
          code: products.catalog
```

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Actions)

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
- `send_message` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `collect_text` - —Å–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç  
- `collect_contact` - —Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏:

```go
// –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Å—Ç–æ–º–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
a.bot.Handle("send_to_crm", a.onSendToCRM)

func (a *App) onSendToCRM(c tele.Context) error {
    session := c.Get("session").(*state.Session)
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ CRM —Å–∏—Å—Ç–µ–º—É
    return a.crmClient.CreateLead(session.Data)
}
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
yamlconf/
‚îú‚îÄ‚îÄ main.go              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ routes.go            # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è flows –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤  
‚îú‚îÄ‚îÄ handlers.go          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
‚îú‚îÄ‚îÄ middleware.go        # –ü–æ–∏—Å–∫ –∏ –∑–∞–ø—É—Å–∫ flows
‚îú‚îÄ‚îÄ flow/               
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ flow.go          # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö flows
‚îÇ   ‚îú‚îÄ‚îÄ fsm.go           # –ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç
‚îÇ   ‚îî‚îÄ‚îÄ registry.go      # –†–µ–µ—Å—Ç—Ä flows
‚îú‚îÄ‚îÄ responses/           # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã –∏ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ main.yaml        # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ support.yaml     # FAQ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ errors.yaml      # –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
‚îú‚îÄ‚îÄ configurator/        # –ó–∞–≥—Ä—É–∑–∫–∞ YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ email/              # –û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ state/              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ storage/            # –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```bash
BOT_TOKEN=your_telegram_bot_token

# SMTP –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π  
SMTP_HOST=smtp.gmail.com
SMTP_PORT=465
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_DEFAULT_EMAIL_FROM=your_email@gmail.com
SMTP_DEFAULT_EMAIL_TO=admin@yourcompany.com
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞:
1. –ù–∞–π–¥–∏—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ flows –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:

- **`greeting`** - –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–±–æ—Ä–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- **`support`** - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫ –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É  
- **`help`** - —Å–±–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–º–æ—â—å –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
